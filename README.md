# Rainbow-Docs

ä¸€ä¸ªåŸºäº Rust æ„å»ºçš„ç°ä»£åŒ–æ–‡æ¡£ç³»ç»Ÿï¼Œç±»ä¼¼ GitBookï¼Œæ”¯æŒç‹¬ç«‹ä½¿ç”¨æˆ–ä¸ Rainbow-Auth è®¤è¯ç³»ç»Ÿé›†æˆã€‚

## åŠŸèƒ½ç‰¹ç‚¹

### ğŸ“š æ–‡æ¡£ç®¡ç†
- **æ–‡æ¡£ç©ºé—´**: ç±»ä¼¼ GitBook çš„ Space æ¦‚å¿µï¼Œæ”¯æŒå¤šä¸ªç‹¬ç«‹çš„æ–‡æ¡£é¡¹ç›®
- **å±‚çº§ç»“æ„**: æ”¯æŒç« èŠ‚åµŒå¥—ï¼Œçµæ´»çš„æ–‡æ¡£ç»„ç»‡æ–¹å¼
- **Markdown ç¼–è¾‘**: å®Œæ•´çš„ Markdown æ”¯æŒï¼Œå¯Œæ–‡æœ¬ç¼–è¾‘ä½“éªŒ
- **å®æ—¶é¢„è§ˆ**: ç¼–è¾‘æ—¶å®æ—¶é¢„è§ˆæ–‡æ¡£æ•ˆæœ
- **ç‰ˆæœ¬æ§åˆ¶**: å®Œæ•´çš„æ–‡æ¡£ç‰ˆæœ¬ç®¡ç†å’Œå†å²è®°å½•

### ğŸ” æƒé™ç³»ç»Ÿ
- **é›†æˆæ¨¡å¼**: ä¸ Rainbow-Auth å®Œå…¨é›†æˆï¼Œä½¿ç”¨ä¼ä¸šçº§ RBAC æƒé™æ§åˆ¶
- **ç‹¬ç«‹æ¨¡å¼**: å¯ç‹¬ç«‹è¿è¡Œï¼Œå†…ç½®åŸºç¡€ç”¨æˆ·ç®¡ç†
- **å¤šç§Ÿæˆ·æ”¯æŒ**: å®Œæ•´çš„ç©ºé—´æˆå‘˜ç®¡ç†å’Œé‚€è¯·ç³»ç»Ÿ
- **ç»†ç²’åº¦æƒé™**: æ”¯æŒç©ºé—´çº§åˆ«å’Œæ–‡æ¡£çº§åˆ«çš„æƒé™æ§åˆ¶
- **è§’è‰²ç®¡ç†**: æ”¯æŒå¤šç§è§’è‰²ï¼šæ‰€æœ‰è€…ã€ç®¡ç†å‘˜ã€ç¼–è¾‘è€…ã€æˆå‘˜ã€é˜…è¯»è€…
- **é‚€è¯·æœºåˆ¶**: é€šè¿‡é‚®ç®±æˆ–ç”¨æˆ·IDé‚€è¯·æˆå‘˜åŠ å…¥ç©ºé—´

### ğŸ” æœç´¢ä¸å‘ç°
- **å…¨æ–‡æœç´¢**: å¿«é€Ÿæœç´¢æ–‡æ¡£å†…å®¹ï¼Œæ”¯æŒé«˜äº®æ˜¾ç¤º
- **é«˜çº§æœç´¢**: æŒ‰ç©ºé—´ã€æ ‡ç­¾ã€ä½œè€…ç­‰æ¡ä»¶ç­›é€‰
- **æœç´¢å»ºè®®**: æ™ºèƒ½æœç´¢è‡ªåŠ¨è¡¥å…¨
- **æœç´¢ç´¢å¼•**: è‡ªåŠ¨ç»´æŠ¤çš„å…¨æ–‡æœç´¢ç´¢å¼•

### ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿ
- **æ ‡ç­¾ç®¡ç†**: åˆ›å»ºã€ç¼–è¾‘ã€åˆ é™¤æ ‡ç­¾
- **æ–‡æ¡£æ ‡è®°**: ä¸ºæ–‡æ¡£æ·»åŠ å¤šä¸ªæ ‡ç­¾
- **æ ‡ç­¾ç»Ÿè®¡**: ä½¿ç”¨é¢‘ç‡å’Œçƒ­é—¨æ ‡ç­¾åˆ†æ
- **æ ‡ç­¾æœç´¢**: æŒ‰æ ‡ç­¾å¿«é€ŸæŸ¥æ‰¾æ–‡æ¡£
- **é¢œè‰²é…ç½®**: è‡ªå®šä¹‰æ ‡ç­¾é¢œè‰²å’Œæ ·å¼

### ğŸ“ æ–‡ä»¶ç®¡ç†
- **å¤šæ ¼å¼æ”¯æŒ**: å›¾ç‰‡ã€æ–‡æ¡£ã€æ–‡æœ¬ã€ä»£ç ã€å‹ç¼©åŒ…ç­‰
- **å›¾ç‰‡å¤„ç†**: è‡ªåŠ¨ç”Ÿæˆç¼©ç•¥å›¾ï¼Œæ”¯æŒå¤šç§å›¾ç‰‡æ ¼å¼
- **æ–‡ä»¶ä¸Šä¼ **: æ”¯æŒæ‹–æ‹½ä¸Šä¼ å’Œæ‰¹é‡ä¸Šä¼ 
- **å®‰å…¨éªŒè¯**: æ–‡ä»¶ç±»å‹æ£€æŸ¥å’Œå¤§å°é™åˆ¶
- **å…³è”ç®¡ç†**: æ–‡ä»¶å¯å…³è”åˆ°æ–‡æ¡£å’Œç©ºé—´
- **æƒé™æ§åˆ¶**: åŸºäºç”¨æˆ·å’Œç©ºé—´çš„è®¿é—®æ§åˆ¶

### ğŸ¤ åä½œåŠŸèƒ½
- **ç©ºé—´æˆå‘˜ç®¡ç†**: é‚€è¯·ã€ç®¡ç†ã€ç§»é™¤æˆå‘˜
- **è§’è‰²æƒé™æ§åˆ¶**: åŸºäºè§’è‰²çš„ç²¾ç»†åŒ–æƒé™ç®¡ç†
- **é‚€è¯·ç³»ç»Ÿ**: æ”¯æŒé‚®ç®±é‚€è¯·å’Œç”¨æˆ·IDé‚€è¯·ï¼Œé‚®ä»¶é€šçŸ¥å’Œç«™å†…é€šçŸ¥
- **è¯„è®ºç³»ç»Ÿ**: æ–‡æ¡£è¯„è®ºå’Œè®¨è®º
- **é€šçŸ¥ç³»ç»Ÿ**: ç«™å†…é€šçŸ¥ï¼Œæ”¯æŒç©ºé—´é‚€è¯·ã€æ–‡æ¡£æ›´æ–°ç­‰å¤šç§é€šçŸ¥ç±»å‹
- **æ´»åŠ¨æ—¥å¿—**: å®Œæ•´çš„æ“ä½œå†å²è®°å½•

### ğŸ“¤ å¯¼å‡ºåŠŸèƒ½
- **å¤šç§æ ¼å¼**: æ”¯æŒ PDFã€HTMLã€ç”µå­ä¹¦ç­‰æ ¼å¼å¯¼å‡º
- **ä¸»é¢˜å®šåˆ¶**: å¯å®šåˆ¶çš„å¯¼å‡ºæ ·å¼å’Œå“ç‰ŒåŒ–

## æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Webæ¡†æ¶**: Axum (ä¸ Rainbow-Auth ç›¸åŒ)
- **æ•°æ®åº“**: SurrealDB (ä¸ Rainbow-Auth ç›¸åŒ)
- **è®¤è¯**: JWT + OAuth 2.0 / OIDC
- **æ–‡æ¡£å¤„ç†**: pulldown-cmark, comrak
- **å¼‚æ­¥è¿è¡Œæ—¶**: Tokio

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Rust 1.87.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- SurrealDB
- Rainbow-Auth (é›†æˆæ¨¡å¼ï¼Œå¯é€‰)
- è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ç”¨äºæ–‡ä»¶å­˜å‚¨

## ğŸš€ å®‰è£…å’Œä½¿ç”¨

Rainbow-Docs æä¾›äº†ä¸¤ç§è¿è¡Œæ¨¡å¼ï¼š**å®‰è£…å‘å¯¼æ¨¡å¼** å’Œ **ç”Ÿäº§æ¨¡å¼**ã€‚

### æ–¹å¼ä¸€ï¼šä½¿ç”¨å®‰è£…å‘å¯¼ï¼ˆæ¨èæ–°ç”¨æˆ·ï¼‰

å®‰è£…å‘å¯¼æä¾›ç±»ä¼¼ WordPress/Discuz çš„ Web ç•Œé¢å®‰è£…ä½“éªŒï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®æ–‡ä»¶ã€‚

#### å¼€å‘ç¯å¢ƒæµ‹è¯•
```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/rainbow-docs.git
cd rainbow-docs

# 2. å¯åŠ¨å®‰è£…æ¨¡å¼ï¼ˆç¼–è¯‘å¹¶è¿è¡Œï¼‰
cargo run --features installer

# 3. æµè§ˆå™¨è®¿é—®å®‰è£…å‘å¯¼
# è®¿é—® http://localhost:3000
# ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æœªå®‰è£…çŠ¶æ€å¹¶æ˜¾ç¤ºå®‰è£…å‘å¯¼
```

#### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# 1. æ„å»ºå®‰è£…ç‰ˆæœ¬
./build.sh installer

# 2. è¿è¡Œç¼–è¯‘å¥½çš„ç¨‹åº
./target/release/rainbow-docs

# 3. æµè§ˆå™¨è®¿é—® http://localhost:3000 å®Œæˆå®‰è£…
```

#### å®‰è£…å‘å¯¼æµç¨‹
1. **ç¯å¢ƒæ£€æŸ¥** - æ£€æŸ¥ç³»ç»Ÿç¯å¢ƒå’Œä¾èµ–
2. **æ•°æ®åº“é…ç½®** - é…ç½® SurrealDB è¿æ¥
3. **ç®¡ç†å‘˜è´¦æˆ·** - åˆ›å»ºç³»ç»Ÿç®¡ç†å‘˜è´¦æˆ·
4. **ç«™ç‚¹é…ç½®** - é…ç½®ç«™ç‚¹åŸºæœ¬ä¿¡æ¯
5. **å®Œæˆå®‰è£…** - ä¿å­˜é…ç½®å¹¶åˆå§‹åŒ–ç³»ç»Ÿ

#### Cargo Run vs Cargo Build çš„åŒºåˆ«

**å¼€å‘æ—¶ä½¿ç”¨ Cargo Run:**
```bash
cargo run                        # ç¼–è¯‘+è¿è¡Œå¼€å‘ç‰ˆæœ¬
cargo run --features installer   # ç¼–è¯‘+è¿è¡Œå®‰è£…ç‰ˆæœ¬
```
- æ¯æ¬¡æ£€æŸ¥ä»£ç å˜åŒ–å¹¶é‡æ–°ç¼–è¯‘
- é€‚åˆå¼€å‘å’Œæµ‹è¯•
- ç¨‹åºè¿è¡Œåœ¨å‰å°ï¼ŒCtrl+C åœæ­¢

**ç”Ÿäº§éƒ¨ç½²ä½¿ç”¨ Cargo Build:**
```bash
cargo build --release            # åªç¼–è¯‘ï¼Œç”Ÿæˆä¼˜åŒ–çš„å¯æ‰§è¡Œæ–‡ä»¶
./target/release/rainbow-docs     # è¿è¡Œç¼–è¯‘å¥½çš„ç¨‹åº
```
- ç”Ÿæˆç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯éƒ¨ç½²åˆ°å…¶ä»–æœºå™¨
- æ€§èƒ½æ›´å¥½ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒ

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨é…ç½®ï¼ˆé«˜çº§ç”¨æˆ·ï¼‰

#### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/yourusername/rainbow-docs.git
cd rainbow-docs
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®æ•°æ®åº“å’Œè®¤è¯ä¿¡æ¯
```

#### 3. åˆå§‹åŒ–æ•°æ®åº“
```bash
# è¿æ¥åˆ° SurrealDB
surreal sql --conn http://localhost:8000 --user root --pass root --ns docs --db main

# å¯¼å…¥æ•°æ®åº“æ¶æ„
surreal import --conn http://localhost:8000 --user root --pass root --ns docs --db main schemas/docs_schema.sql
```

#### 4. æ„å»ºå’Œè¿è¡Œ
```bash
# æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆä¸åŒ…å«å®‰è£…å‘å¯¼ï¼‰
cargo build --release
cargo run

# æˆ–ç›´æ¥è¿è¡Œ
./target/release/rainbow-docs
```

#### 5. éªŒè¯å®‰è£…
```bash
curl http://localhost:3000/health
```

### ğŸ”„ å®‰è£…çŠ¶æ€æ£€æŸ¥æœºåˆ¶

ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æœºåˆ¶åˆ¤æ–­æ˜¯å¦éœ€è¦æ˜¾ç¤ºå®‰è£…å‘å¯¼ï¼š

1. **é¦–æ¬¡å¯åŠ¨**: æ²¡æœ‰ `.rainbow_docs_installed` æ–‡ä»¶ â†’ æ˜¾ç¤ºå®‰è£…å‘å¯¼
2. **å®‰è£…å®Œæˆ**: åˆ›å»º `.rainbow_docs_installed` æ–‡ä»¶ â†’ æ­£å¸¸è¿è¡Œæ¨¡å¼  
3. **é‡æ–°å®‰è£…**: åˆ é™¤ `.rainbow_docs_installed` æ–‡ä»¶ â†’ é‡æ–°æ˜¾ç¤ºå®‰è£…å‘å¯¼

```bash
# é‡æ–°è¿›å…¥å®‰è£…æ¨¡å¼ï¼ˆç”¨äºæµ‹è¯•ï¼‰
rm -f .rainbow_docs_installed
cargo run --features installer
```

### ğŸ› ï¸ æ„å»ºè„šæœ¬ä½¿ç”¨

é¡¹ç›®æä¾›äº†ä¾¿æ·çš„æ„å»ºè„šæœ¬ï¼š

```bash
# æ„å»ºå®‰è£…ç‰ˆæœ¬ï¼ˆåŒ…å«å®‰è£…å‘å¯¼ï¼‰
./build.sh installer

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆä¸åŒ…å«å®‰è£…å‘å¯¼ï¼‰
./build.sh production

# æ„å»ºå¼€å‘ç‰ˆæœ¬
./build.sh dev

# æŸ¥çœ‹å¸®åŠ©
./build.sh
```

### ğŸ“‹ å‰åç«¯é…åˆè¯´æ˜

#### å‰ç«¯æ£€æµ‹é€»è¾‘
å‰ç«¯é€šè¿‡ API è¯·æ±‚æ£€æŸ¥å®‰è£…çŠ¶æ€ï¼š
```javascript
// å‰ç«¯å‘é€è¯·æ±‚æ£€æŸ¥å®‰è£…çŠ¶æ€
const response = await fetch('/api/install/status')
const data = await response.json()

if (!data.data.is_installed) {
  // æ˜¾ç¤ºå®‰è£…å‘å¯¼ç•Œé¢
  return <InstallWizard />
} else {
  // æ˜¾ç¤ºæ­£å¸¸åº”ç”¨ç•Œé¢
  return <NormalApp />
}
```

#### è¯·æ±‚è·¯ç”±
- å‰ç«¯è®¿é—®: `/api/install/status`
- é€šè¿‡ä»£ç†è½¬å‘åˆ°åç«¯: `http://localhost:3000/api/install/status`
- åç«¯æ£€æŸ¥ `.rainbow_docs_installed` æ–‡ä»¶å¹¶è¿”å›çŠ¶æ€

#### å®Œæ•´æµ‹è¯•æµç¨‹
```bash
# 1. å¯åŠ¨åç«¯ï¼ˆå®‰è£…æ¨¡å¼ï¼‰
cd Rainbow-Docs
cargo run --features installer

# 2. å¯åŠ¨å‰ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
cd Rainbow-Docs-Front
npm run dev

# 3. æµè§ˆå™¨è®¿é—® http://localhost:5173
# 4. å‰ç«¯è‡ªåŠ¨æ£€æµ‹å¹¶æ˜¾ç¤ºå®‰è£…å‘å¯¼
```

## é…ç½®è¯´æ˜

### é›†æˆæ¨¡å¼ (æ¨è)
ä¸ Rainbow-Auth é›†æˆï¼Œäº«å—ä¼ä¸šçº§è®¤è¯å’Œæƒé™ç®¡ç†ï¼š

```env
RAINBOW_AUTH_URL=http://localhost:8080
RAINBOW_AUTH_INTEGRATION=true
JWT_SECRET=your-jwt-secret

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760
```

### ç‹¬ç«‹æ¨¡å¼
ç‹¬ç«‹è¿è¡Œï¼Œä½¿ç”¨å†…ç½®ç”¨æˆ·ç³»ç»Ÿï¼š

```env
RAINBOW_AUTH_INTEGRATION=false
JWT_SECRET=your-jwt-secret

# æ–‡ä»¶ä¸Šä¼ é…ç½®
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=10485760
```

### æ–‡ä»¶ä¸Šä¼ é…ç½®
- `UPLOAD_DIR`: æ–‡ä»¶ä¸Šä¼ ç›®å½•ï¼Œé»˜è®¤ä¸º `./uploads`
- `MAX_FILE_SIZE`: æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ï¼Œé»˜è®¤ä¸º 10MB (10485760)

## API æ–‡æ¡£

### è®¤è¯
æ‰€æœ‰APIéœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«æœ‰æ•ˆçš„JWT tokenï¼š
```
Authorization: Bearer <your-jwt-token>
```

### æ–‡æ¡£ç©ºé—´ç®¡ç†

#### è·å–ç©ºé—´åˆ—è¡¨
```http
GET /api/spaces
```

**æŸ¥è¯¢å‚æ•°:**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `search` (å¯é€‰): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹:**
```json
{
  "spaces": [
    {
      "id": "space:123",
      "name": "API Documentation",
      "slug": "api-docs",
      "description": "APIæ¥å£æ–‡æ¡£",
      "is_public": true,
      "created_at": "2024-01-01T00:00:00Z",
      "created_by": "user123"
    }
  ],
  "total_count": 5,
  "page": 1,
  "per_page": 20
}
```

#### åˆ›å»ºç©ºé—´
```http
POST /api/spaces
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "name": "æ–°æ–‡æ¡£ç©ºé—´",
  "slug": "new-space",
  "description": "ç©ºé—´æè¿°",
  "is_public": true
}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "id": "space:456",
  "name": "æ–°æ–‡æ¡£ç©ºé—´",
  "slug": "new-space",
  "description": "ç©ºé—´æè¿°",
  "is_public": true,
  "created_at": "2024-01-15T10:30:00Z",
  "created_by": "user123"
}
```

#### è·å–ç©ºé—´è¯¦æƒ…
```http
GET /api/spaces/{space_id}
```

#### æ›´æ–°ç©ºé—´
```http
PUT /api/spaces/{space_id}
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "name": "æ›´æ–°çš„ç©ºé—´åç§°",
  "description": "æ›´æ–°çš„æè¿°",
  "is_public": false
}
```

#### åˆ é™¤ç©ºé—´
```http
DELETE /api/spaces/{space_id}
```

#### è·å–ç©ºé—´ç»Ÿè®¡
```http
GET /api/spaces/{space_id}/stats
```

### ğŸ§‘â€ğŸ¤â€ğŸ§‘ ç©ºé—´æˆå‘˜ç®¡ç†

#### è·å–ç©ºé—´æˆå‘˜åˆ—è¡¨
```http
GET /api/docs/spaces/{space_slug}/members
```

**æƒé™è¦æ±‚**: éœ€è¦ `members.manage` æƒé™

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": [
    {
      "id": "member:123",
      "space_id": "space:456",
      "user_id": "user:789",
      "role": "editor",
      "permissions": ["docs.read", "docs.write"],
      "status": "accepted",
      "invited_at": "2024-01-01T00:00:00Z",
      "accepted_at": "2024-01-01T01:00:00Z",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-15T10:30:00Z"
    }
  ],
  "message": "Members retrieved successfully"
}
```

#### é‚€è¯·æˆå‘˜åŠ å…¥ç©ºé—´
```http
POST /api/docs/spaces/{space_slug}/invite
Content-Type: application/json
```

**æƒé™è¦æ±‚**: éœ€è¦ `members.invite` æƒé™

**è¯·æ±‚ä½“:**
```json
{
  "email": "user@example.com",
  "role": "editor",
  "message": "æ¬¢è¿åŠ å…¥æˆ‘ä»¬çš„æ–‡æ¡£ç©ºé—´ï¼",
  "expires_in_days": 7
}
```

**æˆ–è€…é€šè¿‡ç”¨æˆ·IDç›´æ¥é‚€è¯·:**
```json
{
  "user_id": "user:123",
  "role": "member",
  "message": "é‚€è¯·ä½ åŠ å…¥æˆ‘ä»¬çš„é¡¹ç›®æ–‡æ¡£",
  "expires_in_days": 30
}
```

**è§’è‰²è¯´æ˜:**
- `owner` - ç©ºé—´æ‰€æœ‰è€…ï¼ˆè‡ªåŠ¨æ‹¥æœ‰æ‰€æœ‰æƒé™ï¼‰
- `admin` - ç®¡ç†å‘˜ï¼ˆå¯ç®¡ç†æ–‡æ¡£ã€é‚€è¯·å’Œç®¡ç†æˆå‘˜ï¼‰
- `editor` - ç¼–è¾‘è€…ï¼ˆå¯è¯»å†™æ–‡æ¡£ï¼‰
- `member` - æˆå‘˜ï¼ˆå¯è¯»å†™æ–‡æ¡£ï¼‰
- `viewer` - é˜…è¯»è€…ï¼ˆåªè¯»æƒé™ï¼‰

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "id": "invitation:789",
    "space_id": "space:456",
    "email": "user@example.com",
    "invite_token": "abc123-def456-ghi789",
    "role": "editor",
    "permissions": ["docs.read", "docs.write"],
    "invited_by": "user:current",
    "message": "æ¬¢è¿åŠ å…¥æˆ‘ä»¬çš„æ–‡æ¡£ç©ºé—´ï¼",
    "expires_at": "2024-01-22T10:30:00Z",
    "created_at": "2024-01-15T10:30:00Z"
  },
  "message": "Invitation sent successfully"
}
```

#### æ¥å—é‚€è¯·
```http
POST /api/docs/spaces/invitations/accept
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "invite_token": "abc123-def456-ghi789"
}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "id": "member:new123",
    "space_id": "space:456",
    "user_id": "user:current",
    "role": "editor",
    "permissions": ["docs.read", "docs.write"],
    "status": "accepted",
    "invited_at": "2024-01-15T10:30:00Z",
    "accepted_at": "2024-01-15T11:00:00Z",
    "created_at": "2024-01-15T11:00:00Z",
    "updated_at": "2024-01-15T11:00:00Z"
  },
  "message": "Invitation accepted successfully"
}
```

#### æ›´æ–°æˆå‘˜æƒé™
```http
PUT /api/docs/spaces/{space_slug}/members/{user_id}
Content-Type: application/json
```

**æƒé™è¦æ±‚**: éœ€è¦ `members.manage` æƒé™

**è¯·æ±‚ä½“:**
```json
{
  "role": "admin",
  "permissions": ["docs.read", "docs.write", "docs.admin", "members.invite"]
}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "id": "member:123",
    "space_id": "space:456",
    "user_id": "user:789",
    "role": "admin",
    "permissions": ["docs.read", "docs.write", "docs.admin", "members.invite"],
    "status": "accepted",
    "updated_at": "2024-01-15T12:00:00Z"
  },
  "message": "Member updated successfully"
}
```

#### ç§»é™¤æˆå‘˜
```http
DELETE /api/docs/spaces/{space_slug}/members/{user_id}
```

**æƒé™è¦æ±‚**: éœ€è¦ `members.remove` æƒé™

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": null,
  "message": "Member removed successfully"
}
```

**æ³¨æ„äº‹é¡¹:**
- ç©ºé—´æ‰€æœ‰è€…ä¸èƒ½è¢«ç§»é™¤
- ç”¨æˆ·ä¸èƒ½ç§»é™¤è‡ªå·±
- åªæœ‰æ‹¥æœ‰ `members.remove` æƒé™çš„ç”¨æˆ·å¯ä»¥ç§»é™¤å…¶ä»–æˆå‘˜

### æƒé™ç³»ç»Ÿè¯¦è§£

#### è§’è‰²æƒé™è¡¨

| è§’è‰² | æƒé™ | è¯´æ˜ |
|-----|-----|------|
| **Owner** | æ‰€æœ‰æƒé™ | ç©ºé—´åˆ›å»ºè€…ï¼Œæ‹¥æœ‰æ‰€æœ‰æ“ä½œæƒé™ |
| **Admin** | `docs.*`, `members.*` | å¯ç®¡ç†æ–‡æ¡£å’Œæˆå‘˜ |
| **Editor** | `docs.read`, `docs.write` | å¯è¯»å†™æ–‡æ¡£ |
| **Member** | `docs.read`, `docs.write` | å¯è¯»å†™æ–‡æ¡£ï¼ˆä¸Editorç›¸åŒï¼‰ |
| **Viewer** | `docs.read` | åªè¯»æƒé™ |

#### æƒé™ä»£ç è¯´æ˜

| æƒé™ä»£ç  | è¯´æ˜ |
|---------|------|
| `docs.read` | è¯»å–æ–‡æ¡£ |
| `docs.write` | åˆ›å»ºå’Œç¼–è¾‘æ–‡æ¡£ |
| `docs.delete` | åˆ é™¤æ–‡æ¡£ |
| `docs.admin` | æ–‡æ¡£ç®¡ç†æƒé™ |
| `space.admin` | ç©ºé—´ç®¡ç†æƒé™ |
| `space.delete` | åˆ é™¤ç©ºé—´æƒé™ |
| `members.invite` | é‚€è¯·æˆå‘˜ |
| `members.manage` | ç®¡ç†æˆå‘˜æƒé™ |
| `members.remove` | ç§»é™¤æˆå‘˜ |

#### æƒé™ç»§æ‰¿

1. **ç©ºé—´æƒé™**: ç”¨æˆ·åœ¨ç©ºé—´ä¸­çš„æƒé™å†³å®šäº†å¯¹è¯¥ç©ºé—´å†…æ‰€æœ‰æ–‡æ¡£çš„è®¿é—®æƒé™
2. **å…¬å¼€ç©ºé—´**: ä»»ä½•äººéƒ½å¯ä»¥è¯»å–å…¬å¼€ç©ºé—´çš„æ–‡æ¡£ï¼ˆå¦‚æœæ–‡æ¡£ä¹Ÿæ˜¯å…¬å¼€çš„ï¼‰
3. **ç§æœ‰ç©ºé—´**: åªæœ‰ç©ºé—´æˆå‘˜å¯ä»¥è®¿é—®ç§æœ‰ç©ºé—´çš„æ–‡æ¡£
4. **æ‰€æœ‰è€…æƒé™**: ç©ºé—´æ‰€æœ‰è€…è‡ªåŠ¨æ‹¥æœ‰è¯¥ç©ºé—´çš„æ‰€æœ‰æƒé™

### æ–‡æ¡£ç®¡ç†

#### è·å–æ–‡æ¡£åˆ—è¡¨
```http
GET /api/docs
```

**æŸ¥è¯¢å‚æ•°:**
- `space_id` (å¯é€‰): ç©ºé—´ID
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `parent_id` (å¯é€‰): çˆ¶æ–‡æ¡£ID

#### åˆ›å»ºæ–‡æ¡£
```http
POST /api/docs
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "space_id": "space:123",
  "title": "æ–°æ–‡æ¡£æ ‡é¢˜",
  "slug": "new-document",
  "content": "# æ–‡æ¡£å†…å®¹\n\nè¿™æ˜¯æ–‡æ¡£å†…å®¹...",
  "description": "æ–‡æ¡£æè¿°",
  "parent_id": "doc:parent",
  "is_public": true
}
```

#### è·å–æ–‡æ¡£è¯¦æƒ…
```http
GET /api/docs/{document_id}
```

#### æ›´æ–°æ–‡æ¡£
```http
PUT /api/docs/{document_id}
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "title": "æ›´æ–°çš„æ ‡é¢˜",
  "content": "æ›´æ–°çš„å†…å®¹",
  "description": "æ›´æ–°çš„æè¿°",
  "is_public": false
}
```

#### åˆ é™¤æ–‡æ¡£
```http
DELETE /api/docs/{document_id}
```

#### ç§»åŠ¨æ–‡æ¡£
```http
PUT /api/docs/{document_id}/move
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "new_parent_id": "doc:new_parent",
  "new_order_index": 5
}
```

#### å¤åˆ¶æ–‡æ¡£
```http
POST /api/docs/{document_id}/duplicate
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "title": "å¤åˆ¶çš„æ–‡æ¡£æ ‡é¢˜",
  "slug": "duplicated-document"
}
```

#### è·å–æ–‡æ¡£é¢åŒ…å±‘
```http
GET /api/docs/{document_id}/breadcrumbs
```

#### è·å–æ–‡æ¡£å­é¡µé¢
```http
GET /api/docs/{document_id}/children
```

### ç‰ˆæœ¬æ§åˆ¶

#### è·å–æ–‡æ¡£ç‰ˆæœ¬åˆ—è¡¨
```http
GET /api/versions/{document_id}/versions
```

**æŸ¥è¯¢å‚æ•°:**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `author_id` (å¯é€‰): æŒ‰ä½œè€…ç­›é€‰

#### åˆ›å»ºæ–°ç‰ˆæœ¬
```http
POST /api/versions/{document_id}/versions
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "title": "æ–‡æ¡£æ ‡é¢˜",
  "content": "æ–‡æ¡£å†…å®¹",
  "summary": "æœ¬æ¬¡æ›´æ”¹çš„æè¿°",
  "change_type": "Updated"
}
```

**change_type å¯é€‰å€¼:** `Created`, `Updated`, `Restored`, `Merged`

#### è·å–å½“å‰ç‰ˆæœ¬
```http
GET /api/versions/{document_id}/versions/current
```

#### è·å–ç‰¹å®šç‰ˆæœ¬
```http
GET /api/versions/{document_id}/versions/{version_id}
```

#### æ¢å¤ç‰ˆæœ¬
```http
POST /api/versions/{document_id}/versions/{version_id}/restore
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "summary": "æ¢å¤åˆ°ç‰ˆæœ¬ 3"
}
```

#### æ¯”è¾ƒç‰ˆæœ¬
```http
GET /api/versions/{document_id}/versions/compare?from_version={version_id_1}&to_version={version_id_2}
```

#### è·å–ç‰ˆæœ¬å†å²æ‘˜è¦
```http
GET /api/versions/{document_id}/versions/summary
```

#### åˆ é™¤ç‰ˆæœ¬
```http
DELETE /api/versions/{document_id}/versions/{version_id}
```

### æœç´¢åŠŸèƒ½

#### å…¨æ–‡æœç´¢
```http
GET /api/search
```

**æŸ¥è¯¢å‚æ•°:**
- `q`: æœç´¢å…³é”®è¯ (å¿…éœ€)
- `space_id` (å¯é€‰): é™åˆ¶åœ¨ç‰¹å®šç©ºé—´å†…æœç´¢
- `tags` (å¯é€‰): æŒ‰æ ‡ç­¾ç­›é€‰ï¼Œé€—å·åˆ†éš”
- `author_id` (å¯é€‰): æŒ‰ä½œè€…ç­›é€‰
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `sort` (å¯é€‰): æ’åºæ–¹å¼ (`relevance`, `created_at`, `updated_at`, `title`)

**å“åº”ç¤ºä¾‹:**
```json
{
  "results": [
    {
      "document_id": "doc:123",
      "space_id": "space:456",
      "title": "APIæ–‡æ¡£",
      "excerpt": "...åŒ…å«æœç´¢å…³é”®è¯çš„æ‘˜è¦...",
      "tags": ["api", "documentation"],
      "author_id": "user123",
      "last_updated": "2024-01-15T10:30:00Z",
      "score": 95.5,
      "highlights": [
        {
          "field": "title",
          "text": "APIæ–‡æ¡£",
          "start": 0,
          "end": 5
        }
      ]
    }
  ],
  "total_count": 42,
  "page": 1,
  "per_page": 20,
  "total_pages": 3,
  "query": "API",
  "took": 15
}
```

#### æœç´¢å»ºè®®
```http
GET /api/search/suggest?q={prefix}&limit=10
```

#### é‡å»ºæœç´¢ç´¢å¼•
```http
POST /api/search/reindex
```

#### ç©ºé—´å†…æœç´¢
```http
GET /api/search/spaces/{space_id}?q={query}
```

#### æŒ‰æ ‡ç­¾æœç´¢
```http
GET /api/search/tags?tags={tag1,tag2}
```

### æ ‡ç­¾ç®¡ç†

#### è·å–æ ‡ç­¾åˆ—è¡¨
```http
GET /api/tags
```

**æŸ¥è¯¢å‚æ•°:**
- `space_id` (å¯é€‰): ç©ºé—´IDï¼Œä¸ºç©ºåˆ™è·å–å…¨å±€æ ‡ç­¾
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `search` (å¯é€‰): æœç´¢å…³é”®è¯

**å“åº”ç¤ºä¾‹:**
```json
{
  "tags": [
    {
      "id": "tag:123",
      "name": "API",
      "slug": "api",
      "description": "APIç›¸å…³æ–‡æ¡£",
      "color": "#10b981",
      "space_id": "space:456",
      "usage_count": 15,
      "created_by": "user123",
      "created_at": "2024-01-01T00:00:00Z",
      "updated_at": "2024-01-15T10:30:00Z"
    }
  ],
  "total_count": 25,
  "page": 1,
  "per_page": 20,
  "total_pages": 2
}
```

#### åˆ›å»ºæ ‡ç­¾
```http
POST /api/tags
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "name": "æ–°æ ‡ç­¾",
  "description": "æ ‡ç­¾æè¿°",
  "color": "#3b82f6",
  "space_id": "space:123"
}
```

#### è·å–æ ‡ç­¾è¯¦æƒ…
```http
GET /api/tags/{tag_id}
```

#### æ›´æ–°æ ‡ç­¾
```http
PUT /api/tags/{tag_id}
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "name": "æ›´æ–°çš„æ ‡ç­¾å",
  "description": "æ›´æ–°çš„æè¿°",
  "color": "#ef4444"
}
```

#### åˆ é™¤æ ‡ç­¾
```http
DELETE /api/tags/{tag_id}
```

#### è·å–çƒ­é—¨æ ‡ç­¾
```http
GET /api/tags/popular?space_id={space_id}&limit=10
```

#### æ ‡ç­¾æœç´¢å»ºè®®
```http
GET /api/tags/suggest?search={query}&space_id={space_id}
```

#### è·å–æ ‡ç­¾ç»Ÿè®¡
```http
GET /api/tags/statistics?space_id={space_id}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "total_tags": 45,
  "used_tags": 32,
  "unused_tags": 13,
  "most_used_tags": [
    {
      "id": "tag:123",
      "name": "API",
      "usage_count": 25
    }
  ]
}
```

#### ä¸ºæ–‡æ¡£æ·»åŠ æ ‡ç­¾
```http
POST /api/tags/documents/tag
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "document_id": "doc:123",
  "tag_ids": ["tag:456", "tag:789"]
}
```

#### è·å–æ–‡æ¡£æ ‡ç­¾
```http
GET /api/tags/documents/{document_id}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "document_id": "doc:123",
  "tags": [
    {
      "id": "tag:456",
      "name": "Tutorial",
      "color": "#3b82f6"
    }
  ]
}
```

#### ç§»é™¤æ–‡æ¡£æ ‡ç­¾
```http
DELETE /api/tags/documents/{document_id}/tags/{tag_id}
```

#### è·å–æ ‡ç­¾å…³è”çš„æ–‡æ¡£
```http
GET /api/tags/{tag_id}/documents?page=1&per_page=20
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "tag_id": "tag:123",
  "document_ids": ["doc:456", "doc:789"],
  "total_count": 15,
  "page": 1,
  "per_page": 20
}
```

### ğŸ“ æ–‡ä»¶ä¸Šä¼ å’Œç®¡ç†

#### ä¸Šä¼ æ–‡ä»¶
```http
POST /api/files
Content-Type: multipart/form-data
```

**è¡¨å•æ•°æ®:**
- `file` (å¿…éœ€): è¦ä¸Šä¼ çš„æ–‡ä»¶
- `space_id` (å¯é€‰): å…³è”çš„ç©ºé—´ID
- `document_id` (å¯é€‰): å…³è”çš„æ–‡æ¡£ID
- `description` (å¯é€‰): æ–‡ä»¶æè¿°

**æ”¯æŒçš„æ–‡ä»¶ç±»å‹:**
- **å›¾ç‰‡**: JPEG, PNG, GIF, WebP, SVG
- **æ–‡æ¡£**: PDF, Word, Excel, PowerPoint
- **æ–‡æœ¬**: TXT, Markdown, CSV
- **ä»£ç **: JSON, XML, HTML, CSS, JavaScript
- **å‹ç¼©åŒ…**: ZIP, TAR, GZIP

**å“åº”ç¤ºä¾‹:**
```json
{
  "id": "file_upload:123",
  "filename": "uuid-filename.jpg",
  "original_name": "my-image.jpg",
  "file_size": 1048576,
  "file_type": "image",
  "mime_type": "image/jpeg",
  "url": "/api/files/file_upload:123/download",
  "thumbnail_url": "/api/files/file_upload:123/thumbnail",
  "space_id": "space:456",
  "document_id": null,
  "uploaded_by": "user123",
  "created_at": "2024-01-15T10:30:00Z"
}
```

#### è·å–æ–‡ä»¶åˆ—è¡¨
```http
GET /api/files
```

**æŸ¥è¯¢å‚æ•°:**
- `space_id` (å¯é€‰): ç©ºé—´IDç­›é€‰
- `document_id` (å¯é€‰): æ–‡æ¡£IDç­›é€‰
- `file_type` (å¯é€‰): æ–‡ä»¶ç±»å‹ç­›é€‰ (`image`, `document`, `text`, `archive`, ç­‰)
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20ï¼Œæœ€å¤§100

**å“åº”ç¤ºä¾‹:**
```json
{
  "files": [
    {
      "id": "file_upload:123",
      "filename": "uuid-filename.jpg",
      "original_name": "my-image.jpg",
      "file_size": 1048576,
      "file_type": "image",
      "mime_type": "image/jpeg",
      "url": "/api/files/file_upload:123/download",
      "thumbnail_url": "/api/files/file_upload:123/thumbnail",
      "space_id": "space:456",
      "document_id": null,
      "uploaded_by": "user123",
      "created_at": "2024-01-15T10:30:00Z"
    }
  ],
  "total_count": 25,
  "page": 1,
  "per_page": 20,
  "total_pages": 2
}
```

#### è·å–æ–‡ä»¶ä¿¡æ¯
```http
GET /api/files/{file_id}
```

#### ä¸‹è½½æ–‡ä»¶
```http
GET /api/files/{file_id}/download
```

**å“åº”:**
- è¿”å›æ–‡ä»¶çš„äºŒè¿›åˆ¶å†…å®¹
- è®¾ç½®æ­£ç¡®çš„ `Content-Type` å’Œ `Content-Disposition` å¤´

#### è·å–å›¾ç‰‡ç¼©ç•¥å›¾
```http
GET /api/files/{file_id}/thumbnail
```

**å“åº”:**
- ä»…é€‚ç”¨äºå›¾ç‰‡æ–‡ä»¶
- è¿”å› 300x300 åƒç´ çš„ JPEG ç¼©ç•¥å›¾
- è®¾ç½®ç¼“å­˜å¤´ `Cache-Control: public, max-age=86400`

#### åˆ é™¤æ–‡ä»¶
```http
DELETE /api/files/{file_id}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "message": "File deleted successfully"
}
```

**æ³¨æ„äº‹é¡¹:**
- æ–‡ä»¶åˆ é™¤é‡‡ç”¨è½¯åˆ é™¤æœºåˆ¶ï¼Œä¸ä¼šç«‹å³åˆ é™¤ç‰©ç†æ–‡ä»¶
- åªæœ‰æ–‡ä»¶ä¸Šä¼ è€…æˆ–å…·æœ‰ç›¸åº”æƒé™çš„ç”¨æˆ·å¯ä»¥åˆ é™¤æ–‡ä»¶
- åˆ é™¤åæ–‡ä»¶ä»ä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼Œä½†æ ‡è®°ä¸ºå·²åˆ é™¤çŠ¶æ€

### è¯„è®ºç³»ç»Ÿ

#### è·å–æ–‡æ¡£è¯„è®ºåˆ—è¡¨
```http
GET /api/comments/document/{document_id}
```

**æŸ¥è¯¢å‚æ•°:**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `per_page` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `sort` (å¯é€‰): æ’åºæ–¹å¼

#### åˆ›å»ºè¯„è®º
```http
POST /api/comments/document/{document_id}
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "content": "è¿™æ˜¯ä¸€æ¡è¯„è®º",
  "parent_id": "comment:parent"
}
```

#### è·å–è¯„è®ºè¯¦æƒ…
```http
GET /api/comments/{comment_id}
```

#### æ›´æ–°è¯„è®º
```http
PUT /api/comments/{comment_id}
Content-Type: application/json
```

**è¯·æ±‚ä½“:**
```json
{
  "content": "æ›´æ–°çš„è¯„è®ºå†…å®¹"
}
```

#### åˆ é™¤è¯„è®º
```http
DELETE /api/comments/{comment_id}
```

#### è·å–è¯„è®ºå›å¤
```http
GET /api/comments/{comment_id}/replies
```

#### ç‚¹èµ/å–æ¶ˆç‚¹èµè¯„è®º
```http
POST /api/comments/{comment_id}/like
```

### ğŸ”” é€šçŸ¥ç³»ç»Ÿ

#### è·å–é€šçŸ¥åˆ—è¡¨
```http
GET /api/docs/notifications
```

**æŸ¥è¯¢å‚æ•°:**
- `page` (å¯é€‰): é¡µç ï¼Œé»˜è®¤ä¸º1
- `limit` (å¯é€‰): æ¯é¡µæ•°é‡ï¼Œé»˜è®¤ä¸º20
- `unread_only` (å¯é€‰): æ˜¯å¦åªæ˜¾ç¤ºæœªè¯»é€šçŸ¥ï¼Œé»˜è®¤ä¸ºfalse

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "notifications": [
      {
        "id": "notification:123",
        "user_id": "user:456",
        "type": "space_invitation",
        "title": "å¼ ä¸‰ é‚€è¯·æ‚¨åŠ å…¥ é¡¹ç›®æ–‡æ¡£ ç©ºé—´",
        "content": "å¼ ä¸‰ é‚€è¯·æ‚¨ä»¥ ç¼–è¾‘è€… çš„èº«ä»½åŠ å…¥ é¡¹ç›®æ–‡æ¡£ ç©ºé—´ã€‚",
        "data": {
          "space_name": "é¡¹ç›®æ–‡æ¡£",
          "invite_token": "abc123-def456",
          "role": "editor",
          "inviter_name": "å¼ ä¸‰"
        },
        "is_read": false,
        "read_at": null,
        "created_at": "2024-01-15T10:30:00Z",
        "updated_at": "2024-01-15T10:30:00Z"
      }
    ],
    "total": 5
  },
  "message": "Notifications retrieved successfully"
}
```

#### è·å–æœªè¯»é€šçŸ¥æ•°é‡
```http
GET /api/docs/notifications/unread-count
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "count": 3
  },
  "message": "Unread count retrieved successfully"
}
```

#### æ ‡è®°é€šçŸ¥ä¸ºå·²è¯»
```http
PUT /api/docs/notifications/{notification_id}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "id": "notification:123",
    "is_read": true,
    "read_at": "2024-01-15T11:00:00Z"
  },
  "message": "Notification marked as read"
}
```

#### æ ‡è®°æ‰€æœ‰é€šçŸ¥ä¸ºå·²è¯»
```http
POST /api/docs/notifications/mark-all-read
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": {
    "updated_count": 5
  },
  "message": "All notifications marked as read"
}
```

#### åˆ é™¤é€šçŸ¥
```http
DELETE /api/docs/notifications/{notification_id}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "success": true,
  "data": null,
  "message": "Notification deleted successfully"
}
```

#### é€šçŸ¥ç±»å‹è¯´æ˜

| é€šçŸ¥ç±»å‹ | è¯´æ˜ | æ•°æ®å­—æ®µ |
|---------|------|----------|
| `space_invitation` | ç©ºé—´é‚€è¯·é€šçŸ¥ | `space_name`, `invite_token`, `role`, `inviter_name` |
| `document_shared` | æ–‡æ¡£åˆ†äº«é€šçŸ¥ | `document_id`, `document_title`, `sharer_name` |
| `comment_mention` | è¯„è®ºæåŠé€šçŸ¥ | `comment_id`, `document_id`, `commenter_name` |
| `document_update` | æ–‡æ¡£æ›´æ–°é€šçŸ¥ | `document_id`, `document_title`, `updater_name` |
| `system` | ç³»ç»Ÿé€šçŸ¥ | è‡ªå®šä¹‰æ•°æ® |

### ç»Ÿè®¡ä¿¡æ¯

#### è·å–æœç´¢ç»Ÿè®¡
```http
GET /api/stats/search
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "total_documents": 156,
  "total_searches_today": 42,
  "most_searched_terms": [
    {
      "term": "API documentation",
      "count": 15
    }
  ],
  "recent_searches": [
    {
      "query": "user management",
      "results_count": 7,
      "timestamp": "2024-01-15T10:30:00Z"
    }
  ]
}
```

#### è·å–æ–‡æ¡£ç»Ÿè®¡
```http
GET /api/stats/documents
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "total_documents": 156,
  "total_spaces": 12,
  "total_comments": 89,
  "documents_created_today": 3,
  "most_active_spaces": [
    {
      "space_id": "space_1",
      "space_name": "API Documentation",
      "document_count": 45,
      "recent_activity": 12
    }
  ]
}
```

## é”™è¯¯å¤„ç†

APIä½¿ç”¨æ ‡å‡†HTTPçŠ¶æ€ç ï¼Œé”™è¯¯å“åº”æ ¼å¼ï¼š

```json
{
  "error": "é”™è¯¯ç±»å‹",
  "message": "è¯¦ç»†é”™è¯¯ä¿¡æ¯",
  "details": "é¢å¤–çš„é”™è¯¯è¯¦æƒ…"
}
```

å¸¸è§çŠ¶æ€ç ï¼š
- `200` - æˆåŠŸ
- `201` - åˆ›å»ºæˆåŠŸ
- `204` - åˆ é™¤æˆåŠŸ
- `400` - è¯·æ±‚å‚æ•°é”™è¯¯
- `401` - æœªè®¤è¯
- `403` - æƒé™ä¸è¶³
- `404` - èµ„æºä¸å­˜åœ¨
- `409` - èµ„æºå†²çª
- `500` - æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

## æ•°æ®åº“æ¶æ„

ç³»ç»Ÿä½¿ç”¨ SurrealDB ä½œä¸ºæ•°æ®åº“ï¼Œæä¾›å®Œæ•´çš„å…³ç³»å‹æ•°æ®åº“åŠŸèƒ½å’Œçµæ´»çš„æ¶æ„è®¾è®¡ã€‚

### æ ¸å¿ƒä¸šåŠ¡è¡¨

#### æ–‡æ¡£ç©ºé—´è¡¨ (space)
- `id` - ç©ºé—´å”¯ä¸€æ ‡è¯†
- `name` - ç©ºé—´åç§°
- `slug` - URLå‹å¥½çš„æ ‡è¯†ç¬¦
- `description` - ç©ºé—´æè¿°
- `is_public` - æ˜¯å¦å…¬å¼€
- `owner_id` - æ‰€æœ‰è€…ç”¨æˆ·ID
- `member_count` - æˆå‘˜æ•°é‡
- `document_count` - æ–‡æ¡£æ•°é‡
- `settings` - ç©ºé—´é…ç½®
- `theme_config` - ä¸»é¢˜é…ç½®

#### ç©ºé—´æˆå‘˜è¡¨ (space_member)
- `id` - æˆå‘˜å…³ç³»å”¯ä¸€æ ‡è¯†
- `space_id` - æ‰€å±ç©ºé—´
- `user_id` - æˆå‘˜ç”¨æˆ·ID
- `role` - æˆå‘˜è§’è‰²ï¼ˆowner/admin/editor/member/viewerï¼‰
- `permissions` - æƒé™åˆ—è¡¨
- `invited_by` - é‚€è¯·è€…ç”¨æˆ·ID
- `invited_at` - é‚€è¯·æ—¶é—´
- `accepted_at` - æ¥å—æ—¶é—´
- `status` - çŠ¶æ€ï¼ˆpending/accepted/rejected/removedï¼‰
- `expires_at` - é‚€è¯·è¿‡æœŸæ—¶é—´

#### ç©ºé—´é‚€è¯·è¡¨ (space_invitation)
- `id` - é‚€è¯·å”¯ä¸€æ ‡è¯†
- `space_id` - ç›®æ ‡ç©ºé—´
- `email` - è¢«é‚€è¯·äººé‚®ç®±
- `user_id` - è¢«é‚€è¯·äººç”¨æˆ·IDï¼ˆå¦‚æœå·²æ³¨å†Œï¼‰
- `invite_token` - å”¯ä¸€é‚€è¯·ä»¤ç‰Œ
- `role` - é¢„è®¾è§’è‰²
- `permissions` - é¢„è®¾æƒé™åˆ—è¡¨
- `invited_by` - é‚€è¯·è€…
- `message` - é‚€è¯·æ¶ˆæ¯
- `max_uses` - æœ€å¤§ä½¿ç”¨æ¬¡æ•°
- `used_count` - å·²ä½¿ç”¨æ¬¡æ•°
- `expires_at` - é‚€è¯·è¿‡æœŸæ—¶é—´

#### æ–‡æ¡£è¡¨ (document)
- `id` - æ–‡æ¡£å”¯ä¸€æ ‡è¯†
- `space_id` - æ‰€å±ç©ºé—´
- `title` - æ–‡æ¡£æ ‡é¢˜
- `slug` - URLå‹å¥½æ ‡è¯†ç¬¦
- `content` - Markdownå†…å®¹
- `excerpt` - æ–‡æ¡£æ‘˜è¦
- `parent_id` - çˆ¶æ–‡æ¡£IDï¼ˆæ”¯æŒå±‚çº§ç»“æ„ï¼‰
- `order_index` - æ’åºç´¢å¼•
- `status` - æ–‡æ¡£çŠ¶æ€ï¼ˆdraft/published/archivedï¼‰
- `word_count` - å­—æ•°ç»Ÿè®¡
- `reading_time` - é¢„è®¡é˜…è¯»æ—¶é—´
- `view_count` - è®¿é—®æ¬¡æ•°

#### ç‰ˆæœ¬æ§åˆ¶è¡¨ (document_version)
- `id` - ç‰ˆæœ¬å”¯ä¸€æ ‡è¯†
- `document_id` - å…³è”æ–‡æ¡£
- `version_number` - ç‰ˆæœ¬å·
- `title` - ç‰ˆæœ¬æ ‡é¢˜
- `content` - ç‰ˆæœ¬å†…å®¹
- `summary` - å˜æ›´æ‘˜è¦
- `change_type` - å˜æ›´ç±»å‹
- `is_current` - æ˜¯å¦å½“å‰ç‰ˆæœ¬
- `author_id` - ä½œè€…ID

### æ ‡ç­¾ç³»ç»Ÿ

#### æ ‡ç­¾è¡¨ (tag)
- `id` - æ ‡ç­¾å”¯ä¸€æ ‡è¯†
- `name` - æ ‡ç­¾åç§°
- `slug` - URLå‹å¥½æ ‡è¯†ç¬¦
- `description` - æ ‡ç­¾æè¿°
- `color` - æ ‡ç­¾é¢œè‰²ï¼ˆåå…­è¿›åˆ¶ï¼‰
- `space_id` - æ‰€å±ç©ºé—´ï¼ˆNULLä¸ºå…¨å±€æ ‡ç­¾ï¼‰
- `usage_count` - ä½¿ç”¨æ¬¡æ•°
- `created_by` - åˆ›å»ºè€…

#### æ–‡æ¡£æ ‡ç­¾å…³è”è¡¨ (document_tag)
- `id` - å…³è”å”¯ä¸€æ ‡è¯†
- `document_id` - æ–‡æ¡£ID
- `tag_id` - æ ‡ç­¾ID
- `tagged_by` - æ ‡è®°è€…
- `tagged_at` - æ ‡è®°æ—¶é—´

### åä½œç³»ç»Ÿ

#### è¯„è®ºè¡¨ (comment)
- `id` - è¯„è®ºå”¯ä¸€æ ‡è¯†
- `document_id` - å…³è”æ–‡æ¡£
- `parent_id` - çˆ¶è¯„è®ºIDï¼ˆæ”¯æŒåµŒå¥—å›å¤ï¼‰
- `author_id` - è¯„è®ºä½œè€…
- `content` - è¯„è®ºå†…å®¹
- `like_count` - ç‚¹èµæ•°
- `liked_by` - ç‚¹èµç”¨æˆ·åˆ—è¡¨
- `is_resolved` - æ˜¯å¦å·²è§£å†³

#### æƒé™è¡¨ (document_permission)
- `id` - æƒé™å”¯ä¸€æ ‡è¯†
- `resource_type` - èµ„æºç±»å‹
- `resource_id` - èµ„æºID
- `user_id` - ç”¨æˆ·ID
- `role_id` - è§’è‰²ID
- `permissions` - æƒé™åˆ—è¡¨
- `expires_at` - è¿‡æœŸæ—¶é—´

### æœç´¢å’Œç´¢å¼•

#### æœç´¢ç´¢å¼•è¡¨ (search_index)
- `id` - ç´¢å¼•å”¯ä¸€æ ‡è¯†
- `document_id` - æ–‡æ¡£ID
- `space_id` - ç©ºé—´ID
- `title` - æ ‡é¢˜
- `content` - çº¯æ–‡æœ¬å†…å®¹
- `tags` - æ ‡ç­¾åˆ—è¡¨
- `is_public` - æ˜¯å¦å…¬å¼€

### ç”¨æˆ·äº¤äº’

#### æ”¶è—è¡¨ (user_favorite)
- `id` - æ”¶è—å”¯ä¸€æ ‡è¯†
- `user_id` - ç”¨æˆ·ID
- `resource_type` - èµ„æºç±»å‹
- `resource_id` - èµ„æºID

#### è®¿é—®è®°å½•è¡¨ (document_view)
- `id` - è®°å½•å”¯ä¸€æ ‡è¯†
- `document_id` - æ–‡æ¡£ID
- `user_id` - ç”¨æˆ·ID
- `duration` - é˜…è¯»æ—¶é•¿
- `ip_address` - IPåœ°å€

### ç³»ç»Ÿè¡¨

#### æ´»åŠ¨æ—¥å¿—è¡¨ (activity_log)
- `id` - æ—¥å¿—å”¯ä¸€æ ‡è¯†
- `user_id` - ç”¨æˆ·ID
- `action` - æ“ä½œç±»å‹
- `resource_type` - èµ„æºç±»å‹
- `resource_id` - èµ„æºID
- `details` - æ“ä½œè¯¦æƒ…

#### æ–‡ä»¶ä¸Šä¼ è¡¨ (file_upload)
- `id` - æ–‡ä»¶å”¯ä¸€æ ‡è¯†
- `filename` - ç³»ç»Ÿç”Ÿæˆçš„æ–‡ä»¶åï¼ˆUUIDï¼‰
- `original_name` - ç”¨æˆ·åŸå§‹æ–‡ä»¶å
- `file_path` - æ–‡ä»¶å­˜å‚¨è·¯å¾„
- `file_size` - æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰
- `file_type` - æ–‡ä»¶ç±»å‹åˆ†ç±»ï¼ˆimage/document/textç­‰ï¼‰
- `mime_type` - MIMEç±»å‹
- `uploaded_by` - ä¸Šä¼ è€…ç”¨æˆ·ID
- `space_id` - å…³è”ç©ºé—´ï¼ˆå¯é€‰ï¼‰
- `document_id` - å…³è”æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰
- `is_deleted` - æ˜¯å¦å·²åˆ é™¤
- `deleted_at` - åˆ é™¤æ—¶é—´
- `deleted_by` - åˆ é™¤è€…

#### é€šçŸ¥è¡¨ (notification)
- `id` - é€šçŸ¥å”¯ä¸€æ ‡è¯†
- `user_id` - æ¥æ”¶è€…ç”¨æˆ·ID
- `type` - é€šçŸ¥ç±»å‹ï¼ˆspace_invitation/document_shared/comment_mention/document_update/systemï¼‰
- `title` - é€šçŸ¥æ ‡é¢˜
- `content` - é€šçŸ¥å†…å®¹
- `data` - é¢å¤–æ•°æ®ï¼ˆJSONæ ¼å¼ï¼Œå¦‚é‚€è¯·ä»¤ç‰Œã€ç©ºé—´åç§°ç­‰ï¼‰
- `is_read` - æ˜¯å¦å·²è¯»
- `read_at` - é˜…è¯»æ—¶é—´
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

### ç´¢å¼•ä¼˜åŒ–

ç³»ç»Ÿä¸ºæ‰€æœ‰è¡¨åˆ›å»ºäº†é€‚å½“çš„ç´¢å¼•ä»¥æå‡æŸ¥è¯¢æ€§èƒ½ï¼š
- ä¸»é”®ç´¢å¼•
- å¤–é”®å…³è”ç´¢å¼•
- æœç´¢å­—æ®µç´¢å¼•
- çŠ¶æ€å­—æ®µç´¢å¼•
- æ—¶é—´å­—æ®µç´¢å¼•

### åˆå§‹æ•°æ®

ç³»ç»Ÿä¼šè‡ªåŠ¨åˆ›å»ºä»¥ä¸‹é»˜è®¤æ ‡ç­¾ï¼š
- APIï¼ˆç»¿è‰²ï¼‰- APIç›¸å…³æ–‡æ¡£
- Tutorialï¼ˆè“è‰²ï¼‰- æ•™ç¨‹æ–‡æ¡£
- Guideï¼ˆç´«è‰²ï¼‰- æŒ‡å—æ–‡æ¡£  
- Referenceï¼ˆæ©™è‰²ï¼‰- å‚è€ƒæ–‡æ¡£
- FAQï¼ˆçº¢è‰²ï¼‰- å¸¸è§é—®é¢˜

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
src/
â”œâ”€â”€ main.rs              # åº”ç”¨å…¥å£
â”œâ”€â”€ config.rs            # é…ç½®ç®¡ç†
â”œâ”€â”€ error.rs             # é”™è¯¯å¤„ç†
â”œâ”€â”€ models/              # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ space.rs         # ç©ºé—´æ¨¡å‹
â”‚   â”œâ”€â”€ space_member.rs  # ç©ºé—´æˆå‘˜æ¨¡å‹
â”‚   â”œâ”€â”€ document.rs      # æ–‡æ¡£æ¨¡å‹
â”‚   â”œâ”€â”€ version.rs       # ç‰ˆæœ¬æ¨¡å‹
â”‚   â”œâ”€â”€ comment.rs       # è¯„è®ºæ¨¡å‹
â”‚   â”œâ”€â”€ permission.rs    # æƒé™æ¨¡å‹
â”‚   â”œâ”€â”€ tag.rs          # æ ‡ç­¾æ¨¡å‹
â”‚   â”œâ”€â”€ file.rs         # æ–‡ä»¶æ¨¡å‹
â”‚   â””â”€â”€ search.rs       # æœç´¢æ¨¡å‹
â”œâ”€â”€ routes/              # è·¯ç”±å¤„ç†
â”‚   â”œâ”€â”€ spaces.rs       # ç©ºé—´è·¯ç”±
â”‚   â”œâ”€â”€ space_members.rs # ç©ºé—´æˆå‘˜ç®¡ç†è·¯ç”±
â”‚   â”œâ”€â”€ documents.rs    # æ–‡æ¡£è·¯ç”±
â”‚   â”œâ”€â”€ versions.rs     # ç‰ˆæœ¬è·¯ç”±
â”‚   â”œâ”€â”€ comments.rs     # è¯„è®ºè·¯ç”±
â”‚   â”œâ”€â”€ search.rs       # æœç´¢è·¯ç”±
â”‚   â”œâ”€â”€ tags.rs         # æ ‡ç­¾è·¯ç”±
â”‚   â”œâ”€â”€ files.rs        # æ–‡ä»¶è·¯ç”±
â”‚   â””â”€â”€ stats.rs        # ç»Ÿè®¡è·¯ç”±
â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ auth.rs         # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ spaces.rs       # ç©ºé—´æœåŠ¡
â”‚   â”œâ”€â”€ space_member.rs # ç©ºé—´æˆå‘˜æœåŠ¡
â”‚   â”œâ”€â”€ documents.rs    # æ–‡æ¡£æœåŠ¡
â”‚   â”œâ”€â”€ versions.rs     # ç‰ˆæœ¬æœåŠ¡
â”‚   â”œâ”€â”€ comments.rs     # è¯„è®ºæœåŠ¡
â”‚   â”œâ”€â”€ search.rs       # æœç´¢æœåŠ¡
â”‚   â”œâ”€â”€ tags.rs         # æ ‡ç­¾æœåŠ¡
â”‚   â””â”€â”€ file_upload.rs  # æ–‡ä»¶ä¸Šä¼ æœåŠ¡
â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
    â””â”€â”€ markdown.rs     # Markdownå¤„ç†
```

### æ·»åŠ æ–°åŠŸèƒ½
1. åœ¨ `models/` ä¸­å®šä¹‰æ•°æ®æ¨¡å‹
2. åœ¨ `services/` ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. åœ¨ `routes/` ä¸­æ·»åŠ  API ç«¯ç‚¹
4. æ›´æ–°æ•°æ®åº“ schema

### æ•°æ®åº“Schemaæ›´æ–°

å¦‚éœ€åº”ç”¨æ–°çš„å¤šç§Ÿæˆ·æƒé™ç³»ç»Ÿï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ•°æ®åº“Schemaæ›´æ–°ï¼š

```sql
-- è¿æ¥åˆ° SurrealDB
surreal sql --conn http://localhost:8000 --user root --pass root --ns docs --db main

-- åº”ç”¨æ–°çš„ç©ºé—´æˆå‘˜å’Œé‚€è¯·è¡¨
```

ç„¶åå¤åˆ¶å¹¶æ‰§è¡Œ `schemas/space_member_schema.sql` ä¸­çš„å†…å®¹ï¼Œè¯¥æ–‡ä»¶åŒ…å«ï¼š

1. **ç©ºé—´æˆå‘˜è¡¨** (`space_member`) - ç®¡ç†ç”¨æˆ·åœ¨ç©ºé—´ä¸­çš„æˆå‘˜å…³ç³»
2. **ç©ºé—´é‚€è¯·è¡¨** (`space_invitation`) - ç®¡ç†é‚€è¯·æµç¨‹
3. **ç›¸å…³ç´¢å¼•** - ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

**é‡è¦è¯´æ˜:**
- æ–°çš„æƒé™ç³»ç»Ÿå‘åå…¼å®¹ï¼Œç°æœ‰ç©ºé—´æ‰€æœ‰è€…æƒé™ä¸å—å½±å“
- å‡çº§åï¼Œç©ºé—´æ‰€æœ‰è€…å¯ä»¥å¼€å§‹é‚€è¯·æˆå‘˜å¹¶åˆ†é…æƒé™
- å…¬å¼€ç©ºé—´çš„è®¿é—®è¡Œä¸ºä¿æŒä¸å˜

## éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²
```bash
# æ„å»ºé•œåƒ
docker build -t rainbow-docs .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name rainbow-docs \
  -p 3000:3000 \
  -e DATABASE_URL=http://surrealdb:8000 \
  -e JWT_SECRET=your-secret \
  rainbow-docs
```

### ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹
1. ä½¿ç”¨å¼ºéšæœº JWT å¯†é’¥
2. é…ç½® HTTPS
3. è®¾ç½®é€‚å½“çš„æ•°æ®åº“æƒé™
4. é…ç½®æ—¥å¿—æ”¶é›†
5. è®¾ç½®å¥åº·æ£€æŸ¥

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License

## æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åˆ›å»º Issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚